# Конфигурация линтера

Этот файл содержит конфигурацию для [golangci-lint](https://golangci-lint.run/) - агрегатора линтеров для Go.

## Зачем это нужно?

Линтер помогает:
- Находить ошибки до компиляции
- Обеспечивать единый стиль кода
- Выявлять проблемы производительности
- Обнаруживать уязвимости безопасности
- Находить неиспользуемый код

## Использование

### Установка

```bash
make install-linter
```

### Проверка кода

```bash
# Просто проверка
make lint

# С автоматическим исправлением
make lint-fix
```

## Включенные линтеры

### Базовые проверки
- **errcheck** - Проверяет, что все ошибки обрабатываются
- **gosimple** - Предлагает упрощения кода
- **govet** - Находит подозрительные конструкции
- **ineffassign** - Находит неэффективные присваивания
- **staticcheck** - Комплексные статические проверки
- **unused** - Находит неиспользуемый код

### Стиль кода
- **gofmt** - Проверяет форматирование
- **goimports** - Проверяет форматирование импортов
- **misspell** - Находит орфографические ошибки в комментариях
- **revive** - Проверяет стиль кода (замена golint)

### Обработка ошибок
- **goerr113** - Проверяет обработку ошибок по стандартам Go 1.13+
- **errname** - Проверяет именование переменных ошибок (должны заканчиваться на Err или Error)

### Производительность
- **prealloc** - Находит срезы, которые можно преаллоцировать для улучшения производительности

### Стиль и читаемость
- **unconvert** - Удаляет ненужные преобразования типов
- **unparam** - Находит неиспользуемые параметры функций
- **whitespace** - Проверяет лишние пробелы

### Безопасность
- **gosec** - Находит проблемы безопасности (SQL injection, weak crypto и т.д.)

### SQL
- **rowserrcheck** - Проверяет обработку ошибок sql.Rows.Err()
- **sqlclosecheck** - Проверяет закрытие sql.Rows и sql.Stmt

## Настройки

### Исключения

1. **Тесты** (`*_test.go`) исключены из проверок:
   - gosec (безопасность)
   - errcheck (обработка ошибок)
   - goerr113 (формат ошибок)

2. **cmd/** (точки входа) исключены из:
   - gosec (допускаем более свободный код в main)

3. **internal/handlers/** исключены из:
   - Проверки экспортируемых комментариев (для краткости)

### Timeout

Таймаут анализа: 5 минут (достаточно для больших проектов)

### Пропущенные директории
- vendor/
- bin/
- .git/

### Формат вывода

Используется `colored-line-number` для удобства чтения.

## Интеграция в CI/CD

Для интеграции в CI/CD добавьте в пайплайн:

```yaml
# GitHub Actions
- name: Run golangci-lint
  uses: golangci/golangci-lint-action@v3
  with:
    version: latest
```

## Дополнительная информация

- [Документация golangci-lint](https://golangci-lint.run/)
- [Список всех линтеров](https://golangci-lint.run/usage/linters/)
- [Примеры конфигурации](https://github.com/golangci/golangci-lint/blob/master/.golangci.example.yml)
